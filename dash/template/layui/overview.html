<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>概览分析</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
        <script src="/static/layui/layui.js" charset="utf-8"></script>
        <script src="/static/echarts/echarts.min.js" charset="utf-8"></script>
        <script src="/static/jquery/jquery-3.6.0.min.js"></script>
        <style type="text/css"> </style>
    </head>
    <body class="layui-layout-body">
        <!-- 数字面板 -->
        <div class="layui-bg-gray" style="padding: 10px;">
            <!-- 数据说明 -->
            <div class="layui-inline layui-anim layui-anim-rotate">
                <button id="notice_button" data-method="notice" class="layui-btn layui-btn-sm layui-btn-radius layui-bg-orange">
                    <i class="layui-icon layui-icon-about"> 数据说明</i>
                </button>
                <!-- 说明弹窗 -->
                <div class="layui-row" id="notice" style="display:none;">
                    &nbsp;&nbsp;&nbsp;&nbsp;1. 数据每日0点更新，看板默认展示2020年11月30日至当日0点的数据情况。<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;2. 主要字段说明如下：<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自媒体主：APP端注册用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;广告主：PC端注册用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;账号：APP端入驻/资源管理后台达人账号<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;活跃用户：7日内有访问行为的用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;沉默用户：大于7日，小于等于30日内有访问行为的用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;流失用户：大于30日没有访问行为的用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;唤醒用户：今日由”沉默用户“变为”活跃用户“的用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;唤回用户：今日由“流失用户”变成“活跃用户”的用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;报名用户：今日有过报名行为的用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;合作用户：今日有生成订单的用户<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APP账号：在APP端入驻的账号<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;媒介账号：后台导入但APP端未申领的账号<br>
                </div>
            </div>
            <!-- 日期选项 -->
            <div class="layui-inline layui-anim layui-anim-down" style="float: right; font-weight: bold;">
                <div class="layui-inline">
                    <label class="layui-form-label layui-font-20 layui-font-blue">日期范围</label>
                </div>
                <div class="layui-inline">
                    <input type="text" autocomplete="off" id="date-range" class="layui-input" placeholder="日期范围">
                </div>
            </div>
            <!-- 数字组图 -->
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md2">
                    <div class="layui-panel layui-anim layui-anim-scaleSpring" style="padding: 10px; height: 50px;">
                        <div class="layui-col-md3">
                            <i class="layui-icon layui-icon-template-1 layui-font-cyan" style="font-size: 30px;"></i>
                        </div>
                        <div class="layui-col-md9">
                            <span class="layui-font-16 layui-font-cyan">账号总数</span>
                            <br />
                            <br />
                            <span id="allAccount" class="layui-font-20 layui-font-red" style="font-weight: bold;">0</span>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="layui-panel layui-anim layui-anim-scaleSpring" style="padding: 10px; height: 50px;">
                        <div class="layui-col-md3">
                            <i class="layui-icon layui-icon-template-1 layui-font-cyan" style="font-size: 30px;"></i>
                        </div>
                        <div class="layui-col-md9">
                            <span class="layui-font-16 layui-font-cyan">任务总数</span>
                            <br />
                            <br />
                            <span id="allTask" class="layui-font-20 layui-font-red" style="font-weight: bold;">0</span>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="layui-panel layui-anim layui-anim-scaleSpring" style="padding: 10px; height: 50px;">
                        <div class="layui-col-md3">
                            <i class="layui-icon layui-icon-template-1 layui-font-cyan" style="font-size: 30px;"></i>
                        </div>
                        <div class="layui-col-md9">
                            <span class="layui-font-16 layui-font-cyan">注册广告主</span>
                            <br />
                            <br />
                            <span id="regAdvert" class="layui-font-20 layui-font-red" style="font-weight: bold;">0</span>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="layui-panel layui-anim layui-anim-scaleSpring" style="padding: 10px; height: 50px;">
                        <div class="layui-col-md3">
                            <i class="layui-icon layui-icon-template-1 layui-font-cyan" style="font-size: 30px;"></i>
                        </div>
                        <div class="layui-col-md9">
                            <span class="layui-font-16 layui-font-cyan">认证广告主</span>
                            <br />
                            <br />
                            <span id="setAdvert" class="layui-font-20 layui-font-red" style="font-weight: bold;">0</span>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="layui-panel layui-anim layui-anim-scaleSpring" style="padding: 10px; height: 50px;">
                        <div class="layui-col-md3">
                            <i class="layui-icon layui-icon-template-1 layui-font-cyan" style="font-size: 30px;"></i>
                        </div>
                        <div class="layui-col-md9">
                            <span class="layui-font-16 layui-font-cyan">注册自媒体主</span>
                            <br />
                            <br />
                            <span id="regMedia" class="layui-font-20 layui-font-red" style="font-weight: bold;">0</span>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="layui-panel layui-anim layui-anim-scaleSpring" style="padding: 10px; height: 50px;">
                        <div class="layui-col-md3">
                            <i class="layui-icon layui-icon-template-1 layui-font-cyan" style="font-size: 30px;"></i>
                        </div>
                        <div class="layui-col-md9">
                            <span class="layui-font-16 layui-font-cyan">入驻自媒体主</span>
                            <br />
                            <br />
                            <span id="setMedia" class="layui-font-20 layui-font-red" style="font-weight: bold;">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <br />

        <!-- 时间趋势与指标对比情况 -->
        <div class="layui-bg-gray" style="padding: 10px;">
            <blockquote class="layui-elem-quote layui-quote-nm">
                <i class="layui-icon layui-icon-chart-screen layui-anim layui-anim-scale layui-font-18"> 时间趋势与指标对比情况</i>
                <button id="sum_button" data-method="sum_choice" class="layui-btn layui-bg-gray layui-anim layui-anim-scale" style="float: right;">
                    <i class="layui-icon layui-icon-set-fill layui-font-18"> 切换指标</i>
                </button>
            </blockquote>
            <!-- 指标内容 -->
            <div class="layui-row layui-col-space10" id="sum_check" style="display:none;">
                <div class="layui-tab layui-tab-brief">
                    <ul class="layui-tab-title">
                        <li class="layui-this">账号指标</li>
                        <li>自媒体主指标</li>
                        <li>广告主指标</li>
                        <li>任务指标</li>
                        <li>IM指标</li>
                    </ul>
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">
                            <form class="layui-form" lay-filter="sumForm" action="">
                                <div class="layui-form-item" pane="">
                                    <div class="layui-input-block">
                                        <input type="checkbox" class="sumCount" name="allAccount" lay-skin="primary" title="全部账号" />
                                        <input type="checkbox" class="sumCount" name="medAccount" lay-skin="primary" title="媒介账号" />
                                        <input type="checkbox" class="sumCount" name="appAccount" lay-skin="primary" title="APP账号" />
                                        <input type="checkbox" class="sumCount" name="perAccount" lay-skin="primary" title="个人账号" />
                                        <input type="checkbox" class="sumCount" name="orgAccount" lay-skin="primary" title="机构账号" />
                                        <input type="checkbox" class="sumCount" name="putAccount" lay-skin="primary" title="投放账号" />
                                        <input type="checkbox" class="sumCount" name="livAccount" lay-skin="primary" title="直播账号" />
                                        <input type="checkbox" class="sumCount" name="notAccount" lay-skin="primary" title="非二道贩子账号" />
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="layui-tab-item">
                            <form class="layui-form" lay-filter="sumForm" action="">
                                <div class="layui-form-item" pane="">
                                    <div class="layui-input-block">
                                        <input type="checkbox" class="sumCount" name="regMedia" lay-skin="primary" title="注册自媒体主" />
                                        <input type="checkbox" class="sumCount" name="setMedia" lay-skin="primary" title="入驻自媒体主" />
                                        <input type="checkbox" class="sumCount" name="perMedia" lay-skin="primary" title="个人自媒体主" />
                                        <input type="checkbox" class="sumCount" name="orgMedia" lay-skin="primary" title="机构自媒体主" />
                                        <input type="checkbox" class="sumCount" name="aorMedia" lay-skin="primary" title="活跃机构" />
                                        <input type="checkbox" class="sumCount" name="actMedia" lay-skin="primary" title="活跃自媒体主" />
                                        <input type="checkbox" class="sumCount" name="secMedia" lay-skin="primary" title="次日留存自媒体主" />
                                        <input type="checkbox" class="sumCount" name="thdMedia" lay-skin="primary" title="三日留存自媒体主" />
                                        <input type="checkbox" class="sumCount" name="sltMedia" lay-skin="primary" title="沉默自媒体主" />
                                        <input type="checkbox" class="sumCount" name="losMedia" lay-skin="primary" title="流失自媒体主" />
                                        <input type="checkbox" class="sumCount" name="bakMedia" lay-skin="primary" title="唤回自媒体主" />
                                        <input type="checkbox" class="sumCount" name="awkMedia" lay-skin="primary" title="唤醒自媒体主" />
                                        <input type="checkbox" class="sumCount" name="enlMedia" lay-skin="primary" title="报名自媒体主" />
                                        <input type="checkbox" class="sumCount" name="cprMedia" lay-skin="primary" title="合作自媒体主" />
                                        <!-- <input type="checkbox" class="sumCount" name="useIMMedia" lay-skin="primary" title="使用IM自媒体主" /> -->
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="layui-tab-item">
                            <form class="layui-form" lay-filter="sumForm" action="">
                                <div class="layui-form-item" pane="">
                                    <div class="layui-input-block">
                                        <input type="checkbox" class="sumCount" name="regAdvert" lay-skin="primary" title="注册广告主" />
                                        <input type="checkbox" class="sumCount" name="setAdvert" lay-skin="primary" title="认证广告主" />
                                        <input type="checkbox" class="sumCount" name="brdAdvert" lay-skin="primary" title="认证品牌主" />
                                        <input type="checkbox" class="sumCount" name="agtAdvert" lay-skin="primary" title="认证代理商" />
                                        <input type="checkbox" class="sumCount" name="padTask" lay-skin="primary" title="发布任务广告主" />
                                        <input type="checkbox" class="sumCount" name="useIMAdvert" lay-skin="primary" title="使用IM广告主" />
                                        <input type="checkbox" class="sumCount" name="staIMAdvert" lay-skin="primary" title="主动发起沟通广告主" />
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="layui-tab-item">
                            <form class="layui-form" lay-filter="sumForm" action="">
                                <div class="layui-form-item" pane="">
                                    <div class="layui-input-block">
                                        <input type="checkbox" class="sumCount" name="allTask" lay-skin="primary" title="全部任务" />
                                        <input type="checkbox" class="sumCount" name="onsTask" lay-skin="primary" title="上架任务" />
                                        <input type="checkbox" class="sumCount" name="offTask" lay-skin="primary" title="下架任务" />
                                        <input type="checkbox" class="sumCount" name="recTask" lay-skin="primary" title="招募任务" />
                                        <input type="checkbox" class="sumCount" name="ivtTask" lay-skin="primary" title="邀约任务" />
                                        <input type="checkbox" class="sumCount" name="prgTask" lay-skin="primary" title="招募/邀约中任务" />
                                        <input type="checkbox" class="sumCount" name="endTask" lay-skin="primary" title="招募/邀约截止任务" />
                                        <input type="checkbox" class="sumCount" name="wtaTask" lay-skin="primary" title="待审核任务" />
                                        <input type="checkbox" class="sumCount" name="excTask" lay-skin="primary" title="执行中任务" />
                                        <input type="checkbox" class="sumCount" name="pubTask" lay-skin="primary" title="已发布任务" />
                                        <input type="checkbox" class="sumCount" name="cmpTask" lay-skin="primary" title="已完成任务" />
                                        <input type="checkbox" class="sumCount" name="clsTask" lay-skin="primary" title="已关闭任务" />
                                        <input type="checkbox" class="sumCount" name="renTask" lay-skin="primary" title="招募名额" />
                                        <input type="checkbox" class="sumCount" name="ivtOrder" lay-skin="primary" title="邀约人次" />
                                        <input type="checkbox" class="sumCount" name="wtaOrder" lay-skin="primary" title="待审核订单" />
                                        <input type="checkbox" class="sumCount" name="prgOrder" lay-skin="primary" title="邀约中订单" />
                                        <input type="checkbox" class="sumCount" name="excOrder" lay-skin="primary" title="执行中订单" />
                                        <input type="checkbox" class="sumCount" name="pubOrder" lay-skin="primary" title="已发布订单" />
                                        <input type="checkbox" class="sumCount" name="cmpOrder" lay-skin="primary" title="已完成订单" />
                                        <input type="checkbox" class="sumCount" name="clsOrder" lay-skin="primary" title="已关闭订单" />
                                        <input type="checkbox" class="sumCount" name="pitTask" lay-skin="primary" title="坑位费+佣金任务数量" />
                                        <input type="checkbox" class="sumCount" name="pitPrice" lay-skin="primary" title="坑位费金额" />
                                        <input type="checkbox" class="sumCount" name="cmsTask" lay-skin="primary" title="纯佣金任务数量" />
                                        <input type="checkbox" class="sumCount" name="sbsTask" lay-skin="primary" title="产品置换任务数量" />
                                        <input type="checkbox" class="sumCount" name="sbsPrice" lay-skin="primary" title="产品置换任务金额" />
                                        <input type="checkbox" class="sumCount" name="cosTask" lay-skin="primary" title="产品+费用任务数量" />
                                        <input type="checkbox" class="sumCount" name="cosPrice" lay-skin="primary" title="产品+费用任务金额" />
                                        <input type="checkbox" class="sumCount" name="prdGood" lay-skin="primary" title="产品金额" />
                                        <input type="checkbox" class="sumCount" name="quoTask" lay-skin="primary" title="账号报价任务数量" />
                                        <input type="checkbox" class="sumCount" name="quoPrice" lay-skin="primary" title="账号报价任务金额" />
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="layui-tab-item">
                            <form class="layui-form" lay-filter="sumForm" action="">
                                <div class="layui-form-item" pane="">
                                    <div class="layui-input-block">
                                        <input type="checkbox" class="sumCount" name="cmcIM" lay-skin="primary" title="沟通总数" />
                                        <input type="checkbox" class="sumCount" name="msgIM" lay-skin="primary" title="消息总数" />
                                        <input type="checkbox" class="sumCount" name="urmIM" lay-skin="primary" title="未读消息数" />
                                        <input type="checkbox" class="sumCount" name="cusIM" lay-skin="primary" title="客服沟通数" />
                                        <input type="checkbox" class="sumCount" name="stcIMAdvert" lay-skin="primary" title="广告主主动发起沟通数" />
                                        <input type="checkbox" class="sumCount" name="urmIMAdvert" lay-skin="primary" title="广告主未读消息数" />
                                        <!-- <input type="checkbox" class="sumCount" name="stcIMMedia" lay-skin="primary" title="自媒体主主动发起沟通数" />
                                        <input type="checkbox" class="sumCount" name="urmIMMedia" lay-skin="primary" title="自媒体主未读消息数" /> -->
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 图表内容 -->
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md4">
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="sumChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
                <div class="layui-col-md8">
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="daysChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>
      
        <br />

        <!-- 用户来源分布及活跃度情况 -->
        <div class="layui-bg-gray" style="padding: 10px;">
            <blockquote class="layui-elem-quote layui-quote-nm">
                <i class="layui-icon layui-icon-chart-screen layui-anim layui-anim-scale layui-font-18"> 用户来源分布及活跃度情况</i>
                <form class="layui-form" action="" style="float: right;">
                    <div class="layui-form-item">
                        <div class="layui-input-inline layui-font-18" style="max-width: 150px;">
                            <select name="source" lay-filter="media">
                                <option value="regMedia" title="全部自媒体主" selected=""></option>
                                <option value="actMedia" title="活跃自媒体主"></option>
                                <option value="secMedia" title="次日留存自媒体主"></option>
                                <option value="thdMedia" title="三日留存自媒体主"></option>
                                <option value="sltMedia" title="沉默自媒体主"></option>
                                <option value="losMedia" title="流失自媒体主"></option>
                                <option value="bakMedia" title="唤回自媒体主"></option>
                                <option value="awkMedia" title="唤醒自媒体主"></option>
                                <option value="enlMedia" title="报名自媒体主"></option>
                                <option value="cprMedia" title="合作自媒体主"></option>
                            </select>
                        </div>
                    </div>
                </form>
            </blockquote>
            <!-- 图表内容 -->
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md4">
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="mediaPie" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
                <div class="layui-col-md8">
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="mediaLine" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <br />

        <!-- 平台分布情况/媒介分布情况 -->
        <div class="layui-bg-gray" style="padding: 10px;">
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md6">
                    <blockquote class="layui-elem-quote layui-quote-nm">
                        <i class="layui-icon layui-icon-chart-screen layui-font-18"> 平台分布情况</i>
                        <button id="plat_button" data-method="plat_choice" class="layui-btn layui-bg-gray" style="float: right;">
                            <i class="layui-icon layui-icon-set-fill layui-font-18"> 切换指标</i>
                        </button>
                    </blockquote>

                    <!-- 指标内容 -->
                    <div class="layui-row layui-col-space10" id="plat_check" style="display:none;">
                        <div class="layui-tab layui-tab-brief">
                            <ul class="layui-tab-title">
                                <li class="layui-this">账号指标</li>
                                <li>自媒体主指标</li>
                                <li>任务指标</li>
                                <!-- <li>IM指标</li> -->
                            </ul>
                            <div class="layui-tab-content">
                                <div class="layui-tab-item layui-show">
                                    <form class="layui-form" lay-filter="platForm" action="">
                                        <div class="layui-form-item" pane="">
                                            <div class="layui-input-block">
                                                <input type="checkbox" class="platCount" name="allAccount" lay-skin="primary" title="全部账号" />
                                                <input type="checkbox" class="platCount" name="medAccount" lay-skin="primary" title="媒介账号" />
                                                <input type="checkbox" class="platCount" name="appAccount" lay-skin="primary" title="APP账号" />
                                                <input type="checkbox" class="platCount" name="perAccount" lay-skin="primary" title="个人账号" />
                                                <input type="checkbox" class="platCount" name="orgAccount" lay-skin="primary" title="机构账号" />
                                                <input type="checkbox" class="platCount" name="putAccount" lay-skin="primary" title="投放账号" />
                                                <input type="checkbox" class="platCount" name="livAccount" lay-skin="primary" title="直播账号" />
                                                <input type="checkbox" class="platCount" name="notAccount" lay-skin="primary" title="非二道贩子账号" />
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="layui-tab-item">
                                    <form class="layui-form" lay-filter="platForm" action="">
                                        <div class="layui-form-item" pane="">
                                            <div class="layui-input-block">
                                                <input type="checkbox" class="platCount" name="regMedia" lay-skin="primary" title="注册自媒体主" />
                                                <input type="checkbox" class="platCount" name="setMedia" lay-skin="primary" title="入驻自媒体主" />
                                                <input type="checkbox" class="platCount" name="perMedia" lay-skin="primary" title="个人自媒体主" />
                                                <input type="checkbox" class="platCount" name="orgMedia" lay-skin="primary" title="机构自媒体主" />
                                                <input type="checkbox" class="platCount" name="aorMedia" lay-skin="primary" title="活跃机构" />
                                                <input type="checkbox" class="platCount" name="actMedia" lay-skin="primary" title="活跃自媒体主" />
                                                <input type="checkbox" class="platCount" name="secMedia" lay-skin="primary" title="次日留存自媒体主" />
                                                <input type="checkbox" class="platCount" name="thdMedia" lay-skin="primary" title="三日留存自媒体主" />
                                                <input type="checkbox" class="platCount" name="sltMedia" lay-skin="primary" title="沉默自媒体主" />
                                                <input type="checkbox" class="platCount" name="losMedia" lay-skin="primary" title="流失自媒体主" />
                                                <input type="checkbox" class="platCount" name="bakMedia" lay-skin="primary" title="唤回自媒体主" />
                                                <input type="checkbox" class="platCount" name="awkMedia" lay-skin="primary" title="唤醒自媒体主" />
                                                <input type="checkbox" class="platCount" name="enlMedia" lay-skin="primary" title="报名自媒体主" />
                                                <input type="checkbox" class="platCount" name="cprMedia" lay-skin="primary" title="合作自媒体主" />
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="layui-tab-item">
                                    <form class="layui-form" lay-filter="platForm" action="">
                                        <div class="layui-form-item" pane="">
                                            <div class="layui-input-block">
                                                <input type="checkbox" class="platCount" name="allTask" lay-skin="primary" title="全部任务" />
                                                <input type="checkbox" class="platCount" name="onsTask" lay-skin="primary" title="上架任务" />
                                                <input type="checkbox" class="platCount" name="offTask" lay-skin="primary" title="下架任务" />
                                                <input type="checkbox" class="platCount" name="recTask" lay-skin="primary" title="招募任务" />
                                                <input type="checkbox" class="platCount" name="ivtTask" lay-skin="primary" title="邀约任务" />
                                                <input type="checkbox" class="platCount" name="prgTask" lay-skin="primary" title="招募/邀约中任务" />
                                                <input type="checkbox" class="platCount" name="endTask" lay-skin="primary" title="招募/邀约截止任务" />
                                                <input type="checkbox" class="platCount" name="wtaTask" lay-skin="primary" title="待审核任务" />
                                                <input type="checkbox" class="platCount" name="excTask" lay-skin="primary" title="执行中任务" />
                                                <input type="checkbox" class="platCount" name="pubTask" lay-skin="primary" title="已发布任务" />
                                                <input type="checkbox" class="platCount" name="cmpTask" lay-skin="primary" title="已完成任务" />
                                                <input type="checkbox" class="platCount" name="clsTask" lay-skin="primary" title="已关闭任务" />
                                                <input type="checkbox" class="platCount" name="renTask" lay-skin="primary" title="招募名额" />
                                                <input type="checkbox" class="platCount" name="ivtOrder" lay-skin="primary" title="邀约人次" />
                                                <input type="checkbox" class="platCount" name="wtaOrder" lay-skin="primary" title="待审核订单" />
                                                <input type="checkbox" class="platCount" name="prgOrder" lay-skin="primary" title="邀约中订单" />
                                                <input type="checkbox" class="platCount" name="excOrder" lay-skin="primary" title="执行中订单" />
                                                <input type="checkbox" class="platCount" name="pubOrder" lay-skin="primary" title="已发布订单" />
                                                <input type="checkbox" class="platCount" name="cmpOrder" lay-skin="primary" title="已完成订单" />
                                                <input type="checkbox" class="platCount" name="clsOrder" lay-skin="primary" title="已关闭订单" />
                                                <input type="checkbox" class="platCount" name="pitTask" lay-skin="primary" title="坑位费+佣金任务数量" />
                                                <input type="checkbox" class="platCount" name="pitPrice" lay-skin="primary" title="坑位费金额" />
                                                <input type="checkbox" class="platCount" name="cmsTask" lay-skin="primary" title="纯佣金任务数量" />
                                                <input type="checkbox" class="platCount" name="sbsTask" lay-skin="primary" title="产品置换任务数量" />
                                                <input type="checkbox" class="platCount" name="sbsPrice" lay-skin="primary" title="产品置换任务金额" />
                                                <input type="checkbox" class="platCount" name="cosTask" lay-skin="primary" title="产品+费用任务数量" />
                                                <input type="checkbox" class="platCount" name="cosPrice" lay-skin="primary" title="产品+费用任务金额" />
                                                <input type="checkbox" class="platCount" name="prdGood" lay-skin="primary" title="产品金额" />
                                                <input type="checkbox" class="platCount" name="quoTask" lay-skin="primary" title="账号报价任务数量" />
                                                <input type="checkbox" class="platCount" name="quoPrice" lay-skin="primary" title="账号报价任务金额" />
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <!-- <div class="layui-tab-item">
                                    <form class="layui-form" action="">
                                        <div class="layui-form-item" pane="">
                                            <div class="layui-input-block">
                                                <input type="checkbox" class="platCount" name="cmcIMMedia" lay-skin="primary" title="沟通总数" />
                                                <input type="checkbox" class="platCount" name="msgIMMedia" lay-skin="primary" title="消息总数" />
                                                <input type="checkbox" class="platCount" name="urmIMMedia" lay-skin="primary" title="未读消息数" />
                                                <input type="checkbox" class="platCount" name="stcIMMedia" lay-skin="primary" title="自媒体主主动发起沟通数" />
                                                <input type="checkbox" class="platCount" name="urmIMMedia" lay-skin="primary" title="自媒体主未读消息数" />
                                            </div>
                                        </div>
                                    </form>
                                </div> -->
                            </div>
                        </div>
                    </div>
                    <!-- 图表内容 -->
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="platChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
                <div class="layui-col-md6">
                    <blockquote class="layui-elem-quote layui-quote-nm">
                        <i class="layui-icon layui-icon-chart-screen layui-font-18"> 媒介分布情况</i>
                        <button id="medium_button" data-method="medium_choice" class="layui-btn layui-bg-gray" style="float: right;">
                            <i class="layui-icon layui-icon-set-fill layui-font-18"> 切换指标</i>
                        </button>
                    </blockquote>
                    <!-- 指标内容 -->
                    <div class="layui-row layui-col-space10" id="medium_check" style="display:none;">
                        <div class="layui-tab layui-tab-brief">
                            <ul class="layui-tab-title">
                                <li class="layui-this">账号指标</li>
                                <li>自媒体主指标</li>
                                <!-- <li>IM指标</li> -->
                            </ul>
                            <div class="layui-tab-content">
                                <div class="layui-tab-item layui-show">
                                    <form class="layui-form" lay-filter="mediumForm" action="">
                                        <div class="layui-form-item" pane="">
                                            <div class="layui-input-block">
                                                <input type="checkbox" class="mediumCount" name="allAccount" lay-skin="primary" title="全部账号" />
                                                <input type="checkbox" class="mediumCount" name="medAccount" lay-skin="primary" title="媒介账号" />
                                                <input type="checkbox" class="mediumCount" name="appAccount" lay-skin="primary" title="APP账号" />
                                                <input type="checkbox" class="mediumCount" name="perAccount" lay-skin="primary" title="个人账号" />
                                                <input type="checkbox" class="mediumCount" name="orgAccount" lay-skin="primary" title="机构账号" />
                                                <input type="checkbox" class="mediumCount" name="putAccount" lay-skin="primary" title="投放账号" />
                                                <input type="checkbox" class="mediumCount" name="livAccount" lay-skin="primary" title="直播账号" />
                                                <input type="checkbox" class="mediumCount" name="notAccount" lay-skin="primary" title="非二道贩子账号" />
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="layui-tab-item">
                                    <form class="layui-form" lay-filter="mediumForm" action="">
                                        <div class="layui-form-item" pane="">
                                            <div class="layui-input-block">
                                                <input type="checkbox" class="mediumCount" name="regMedia" lay-skin="primary" title="注册自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="setMedia" lay-skin="primary" title="入驻自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="perMedia" lay-skin="primary" title="个人自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="orgMedia" lay-skin="primary" title="机构自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="aorMedia" lay-skin="primary" title="活跃机构" />
                                                <input type="checkbox" class="mediumCount" name="actMedia" lay-skin="primary" title="活跃自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="secMedia" lay-skin="primary" title="次日留存自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="thdMedia" lay-skin="primary" title="三日留存自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="sltMedia" lay-skin="primary" title="沉默自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="losMedia" lay-skin="primary" title="流失自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="bakMedia" lay-skin="primary" title="唤回自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="awkMedia" lay-skin="primary" title="唤醒自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="enlMedia" lay-skin="primary" title="报名自媒体主" />
                                                <input type="checkbox" class="mediumCount" name="cprMedia" lay-skin="primary" title="合作自媒体主" />
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <!-- <div class="layui-tab-item">
                                    <form class="layui-form" action="">
                                        <div class="layui-form-item" pane="">
                                            <div class="layui-input-block">
                                                <input type="checkbox" class="mediumCount" name="cmcIMMedia" lay-skin="primary" title="沟通总数" />
                                                <input type="checkbox" class="mediumCount" name="msgIMMedia" lay-skin="primary" title="消息总数" />
                                                <input type="checkbox" class="mediumCount" name="urmIMMedia" lay-skin="primary" title="未读消息数" />
                                                <input type="checkbox" class="mediumCount" name="stcIMMedia" lay-skin="primary" title="自媒体主主动发起沟通数" />
                                                <input type="checkbox" class="mediumCount" name="urmIMMedia" lay-skin="primary" title="自媒体主未读消息数" />
                                            </div>
                                        </div>
                                    </form>
                                </div> -->
                            </div>
                        </div>
                    </div>
                    <!-- 图表内容 -->
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="mediumChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <br />

        <!-- 领域分布情况/行业分布情况 -->
        <div class="layui-bg-gray" style="padding: 10px;">
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md6">
                    <blockquote class="layui-elem-quote layui-quote-nm">
                        <i class="layui-icon layui-icon-chart-screen layui-anim layui-anim-scale layui-font-18"> 领域分布情况</i>
                        <form class="layui-form" action="" style="float: right;">
                            <div class="layui-form-item">
                                <div class="layui-input-inline layui-font-18" style="max-width: 150px;">
                                    <select name="cate" lay-filter="account">
                                        <option value="allAccount" title="全部账号" selected=""></option>
                                        <option value="medAccount" title="媒介账号"></option>
                                        <option value="appAccount" title="APP账号"></option>
                                        <option value="perAccount" title="个人账号"></option>
                                        <option value="orgAccount" title="机构账号"></option>
                                        <option value="putAccount" title="投放账号"></option>
                                        <option value="livAccount" title="直播账号"></option>
                                        <option value="notAccount" title="非二道贩子账号"></option>
                                        <option value="allTask" title="全部任务"></option>
                                        <option value="onsTask" title="上架任务"></option>
                                        <option value="offTask" title="下架任务"></option>
                                        <option value="recTask" title="招募任务"></option>
                                        <option value="ivtTask" title="邀约任务"></option>
                                        <option value="prgTask" title="招募/邀约中任务"></option>
                                        <option value="endTask" title="招募/邀约截止任务"></option>
                                        <option value="wtaTask" title="待审核任务"></option>
                                        <option value="excTask" title="执行中任务"></option>
                                        <option value="pubTask" title="已发布任务"></option>
                                        <option value="cmpTask" title="已完成任务"></option>
                                        <option value="clsTask" title="已关闭任务"></option>
                                        <option value="renTask" title="招募名额"></option>
                                        <option value="ivtOrder" title="邀约人次"></option>
                                        <option value="wtaOrder" title="待审核订单"></option>
                                        <option value="prgOrder" title="邀约中订单"></option>
                                        <option value="excOrder" title="执行中订单"></option>
                                        <option value="pubOrder" title="已发布订单"></option>
                                        <option value="cmpOrder" title="已完成订单"></option>
                                        <option value="clsOrder" title="已关闭订单"></option>
                                        <option value="pitTask" title="坑位费+佣金任务数量"></option>
                                        <option value="pitPrice" title="坑位费金额"></option>
                                        <option value="cmsTask" title="纯佣金任务数量"></option>
                                        <option value="sbsTask" title="产品置换任务数量"></option>
                                        <option value="sbsPrice" title="产品置换任务金额"></option>
                                        <option value="cosTask" title="产品+费用任务数量"></option>
                                        <option value="cosPrice" title="产品+费用任务金额"></option>
                                        <option value="prdGood" title="产品金额"></option>
                                        <option value="quoTask" title="账号报价任务数量"></option>
                                        <option value="quoPrice" title="账号报价任务金额"></option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </blockquote>
                    <!-- 图表内容 -->
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="cateTopChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
                <div class="layui-col-md6">
                    <blockquote class="layui-elem-quote layui-quote-nm">
                        <i class="layui-icon layui-icon-chart-screen layui-anim layui-anim-scale layui-font-18"> 行业分布情况</i>
                        <form class="layui-form" action="" style="float: right;">
                            <div class="layui-form-item">
                                <div class="layui-input-inline">
                                    <input type="radio" name="industry" lay-filter="level" value="pid" title="一级" checked="">
                                    <input type="radio" name="industry" lay-filter="level" value="cid" title="二级">
                                </div>
                                <div class="layui-input-inline layui-font-18" style="max-width: 150px">
                                    <select name="indus" lay-filter="indus">
                                        <option value="setAdvert" title="认证广告主" selected=""></option>
                                        <option value="brdAdvert" title="认证品牌主"></option>
                                        <option value="agtAdvert" title="认证代理商"></option>
                                        <option value="pubAdvert" title="发布任务广告主"></option>
                                        <option value="uimAdvert" title="使用IM广告主"></option>
                                        <option value="iniAdvert" title="主动发起沟通广告主"></option>
                                        <option value="allTask" title="全部任务"></option>
                                        <option value="onsTask" title="上架任务"></option>
                                        <option value="offTask" title="下架任务"></option>
                                        <option value="recTask" title="招募任务"></option>
                                        <option value="ivtTask" title="邀约任务"></option>
                                        <option value="prgTask" title="招募/邀约中任务"></option>
                                        <option value="endTask" title="招募/邀约截止任务"></option>
                                        <option value="wtaTask" title="待审核任务"></option>
                                        <option value="excTask" title="执行中任务"></option>
                                        <option value="pubTask" title="已发布任务"></option>
                                        <option value="cmpTask" title="已完成任务"></option>
                                        <option value="clsTask" title="已关闭任务"></option>
                                        <option value="renTask" title="招募名额"></option>
                                        <option value="ivtOrder" title="邀约人次"></option>
                                        <option value="wtaOrder" title="待审核订单"></option>
                                        <option value="prgOrder" title="邀约中订单"></option>
                                        <option value="excOrder" title="执行中订单"></option>
                                        <option value="pubOrder" title="已发布订单"></option>
                                        <option value="cmpOrder" title="已完成订单"></option>
                                        <option value="clsOrder" title="已关闭订单"></option>
                                        <option value="pitTask" title="坑位费+佣金任务数量"></option>
                                        <option value="pitPrice" title="坑位费金额"></option>
                                        <option value="cmsTask" title="纯佣金任务数量"></option>
                                        <option value="sbsTask" title="产品置换任务数量"></option>
                                        <option value="sbsPrice" title="产品置换任务金额"></option>
                                        <option value="cosTask" title="产品+费用任务数量"></option>
                                        <option value="cosPrice" title="产品+费用任务金额"></option>
                                        <option value="prdGood" title="产品金额"></option>
                                        <option value="quoTask" title="账号报价任务数量"></option>
                                        <option value="quoPrice" title="账号报价任务金额"></option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </blockquote>
                    <!-- 图表内容 -->
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="indusTopChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <br />

        <!-- 机构分布情况/广告主分布情况 -->
        <div class="layui-bg-gray" style="padding: 10px;">
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md6">
                    <blockquote class="layui-elem-quote layui-quote-nm">
                        <i class="layui-icon layui-icon-chart-screen layui-anim layui-anim-scale layui-font-18"> 机构分布情况</i>
                        <form class="layui-form" action="" style="float: right;">
                            <div class="layui-form-item">
                                <div class="layui-input-inline layui-font-18" style="max-width: 150px;">
                                    <select name="organization" lay-filter="organization">
                                        <option value="allAccount" title="账号总数" selected=""></option>
                                        <option value="smfAccount" title="粉丝总数"></option>
                                        <option value="avfAccount" title="粉丝数均值"></option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </blockquote>
                    <!-- 图表内容 -->
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="orgnTopChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
                <div class="layui-col-md6">
                    <blockquote class="layui-elem-quote layui-quote-nm">
                        <i class="layui-icon layui-icon-chart-screen layui-anim layui-anim-scale layui-font-18"> 广告主分布情况</i>
                        <form class="layui-form" action="" style="float: right;">
                            <div class="layui-form-item">
                                <div class="layui-input-inline layui-font-18" style="max-width: 150px;">
                                    <select name="advert" lay-filter="advert">
                                        <option value="allTask" title="全部任务" selected=""></option>
                                        <option value="onsTask" title="上架任务"></option>
                                        <option value="offTask" title="下架任务"></option>
                                        <option value="recTask" title="招募任务"></option>
                                        <option value="ivtTask" title="邀约任务"></option>
                                        <option value="prgTask" title="招募/邀约中任务"></option>
                                        <option value="endTask" title="招募/邀约截止任务"></option>
                                        <option value="wtaTask" title="待审核任务"></option>
                                        <option value="excTask" title="执行中任务"></option>
                                        <option value="pubTask" title="已发布任务"></option>
                                        <option value="cmpTask" title="已完成任务"></option>
                                        <option value="clsTask" title="已关闭任务"></option>
                                        <option value="renTask" title="招募名额"></option>
                                        <option value="ivtOrder" title="邀约人次"></option>
                                        <option value="wtaOrder" title="待审核订单"></option>
                                        <option value="prgOrder" title="邀约中订单"></option>
                                        <option value="excOrder" title="执行中订单"></option>
                                        <option value="pubOrder" title="已发布订单"></option>
                                        <option value="cmpOrder" title="已完成订单"></option>
                                        <option value="clsOrder" title="已关闭订单"></option>
                                        <option value="pitTask" title="坑位费+佣金任务数量"></option>
                                        <option value="pitPrice" title="坑位费金额"></option>
                                        <option value="cmsTask" title="纯佣金任务数量"></option>
                                        <option value="sbsTask" title="产品置换任务数量"></option>
                                        <option value="sbsPrice" title="产品置换任务金额"></option>
                                        <option value="cosTask" title="产品+费用任务数量"></option>
                                        <option value="cosPrice" title="产品+费用任务金额"></option>
                                        <option value="prdGood" title="产品金额"></option>
                                        <option value="quoTask" title="账号报价任务数量"></option>
                                        <option value="quoPrice" title="账号报价任务金额"></option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </blockquote>
                    <!-- 图表内容 -->
                    <div class="layui-panel layui-anim layui-anim-scale">
                        <div id="adveTopChart" style="width: auto;height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <br />

        <script type="text/javascript">

            // system base data
            var platMap = {}, mediumMap = {}, categoryMap = {}, parentMap = {}
            var childMap = {}, organizationMap = {}, advertMap = {}
            
            var startDate = "2020-11-01", endDate = "2020-11-02"
            var sumChoiceList = ["recTask", "ivtTask"]
            var platChoiceList = ["allAccount", "notAccount"]
            var mediumChoiceList = ["allAccount", "notAccount"]

            var sumTotal = {}, platTotal = {}, mediumTotal = {}
            var parentTotal = {}, childTotal = {}, organizationTotal = {}, advertTotal = {}

            var daysList = [], daysNameList = [], daysSeriesList = []

            var sourceTotal = {}, sourceNameList = [], sourceSeriesList = [], pieSeriesList = []

            var platSource = [], platSeries = [], medSource = [], medSeries = []

            var fanTopNameList = [], fanTopDataList = [], taskTopNameList = [], taskTopDataList = []

            var cateNameList = [], cateDataList = [], indusNameList = [], indusDataList = []

            // 获取前一天时间
            function getNow() {
                var myDate = new Date();
                myDate.setDate(myDate.getDate() - 1);

                year = myDate.getFullYear()
                month = myDate.getMonth() + 1
                day = myDate.getDate()
                if (month < 10) month = '0' + month;
                if (day < 10) day = '0' + day;
                endDate = year + "-" + month + "-" + day
                
            }
            //日期范围
            layui.use('laydate', function(){
                var laydate = layui.laydate;
                
                laydate.render({
                    elem: '#date-range', theme: '#393D49', showBottom: true, btns: ['confirm'], 
                    min: '2020-11-01', max: endDate,
                    range: '~',
                    value: startDate + ' ~ ' + endDate, isInitValue: true,
                    done: function(value, start, end){
                        
                        year = start["year"]
                        month = start["month"]
                        day = start["date"]
                        if (month < 10) month = '0' + month;
                        if (day < 10) day = '0' + day;

                        startDate = year + "-" + month + "-" + day

                        year = end["year"]
                        month = end["month"]
                        day = end["date"]
                        if (month < 10) month = '0' + month;
                        if (day < 10) day = '0' + day;

                        endDate = year + "-" + month + "-" + day                  
                        
                        getData();
                        putSum(false);
                        sumView();
                        putSource();
                        sourceView();
                        putPlat(false)
                        putMedium(false)
                        PlatMediumView()

                    }
                    
                });             
            });

            function getBase() {
                $.ajax({
                    // url: 'http://127.0.0.1:18081/api/base',
                    url: '//inter.lolqq.xyz/api/base',
                    type : "get", 
                    dataType: 'json',
                    timeout: 5000,
                    async: false,
                    // beforeSend: function (XMLHttpRequest) {
                    //     layer.load(1);
                    // },
                    success : function(result){
                        // 清空日期和数据
                        platMap = result.data.platMap
                        mediumMap = result.data.mediumMap
                        parentMap = result.data.parentMap
                        childMap = result.data.childMap
                        categoryMap = result.data.categoryMap
                        organizationMap = result.data.organizationMap
                        advertMap = result.data.advertMap
                    },
                    error : function(result){ 
                        // alert("读取数据错误");
                    },
                    complete:function (XMLHttpRequest, status) {
                    //     // alert("加载完成")
                    }
                });
            };

            function getData() {

                $.ajax({
                    // url: 'http://127.0.0.1:18081/api/overview?startDate='+startDate+'&endDate='+endDate,
                    url: '//inter.lolqq.xyz/api/overview?startDate='+startDate+'&endDate='+endDate,
                    type : "get", 
                    dataType: 'json',
                    timeout: 5000,
                    async: false,
                    // beforeSend: function (XMLHttpRequest) {
                    //     layer.load(1);
                    // },
                    success : function(result){
                        // 清空日期和数据
                        daysList = [], sumTotal = {}
                        platTotal = {}, mediumTotal = {}
                        sourceTotal = {}

                        daysList = result.data.daysList
                        sumTotal = result.data.sumTotal
                        sourceTotal = result.data.sourceTotal
                    
                        platTotal = result.data.platTotal
                        mediumTotal = result.data.mediumTotal

                        cateTotal = result.data.cateTotal
                        parentTotal = result.data.parentTotal
                        childTotal = result.data.childTotal

                        organizationTotal = result.data.organizationTotal
                        advertTotal = result.data.advertTotal


                    },
                    error : function(result){ 
                        alert("读取数据错误");
                    },
                    // complete:function (XMLHttpRequest, status) {
                    //     // alert("加载完成")
                    // }
                });
            };         


            function putSelect() {

                $("select[name='indus'] option").each(function(i, item){
                    child_title = $("select[name='indus'] option").eq(i).attr("title");
                    if (child_title.length > 0) {
                        if (child_title.length > 5) {
                            sub_title = child_title.substring(0,5) + "..."
                            $("select[name='indus'] option").eq(i).text(sub_title);
                        } else {
                            $("select[name='indus'] option").eq(i).text(child_title);
                        }
                    } 
                });

                $("select[name='advert'] option").each(function(i, item){
                    child_title = $("select[name='advert'] option").eq(i).attr("title");
                    if (child_title.length > 0) {
                        if (child_title.length > 5) {
                            sub_title = child_title.substring(0,5) + "..."
                            $("select[name='advert'] option").eq(i).text(sub_title);
                        } else {
                            $("select[name='advert'] option").eq(i).text(child_title);
                        }
                    } 
                });

                $("select[name='organization'] option").each(function(i, item){
                    child_title = $("select[name='organization'] option").eq(i).attr("title");
                    if (child_title.length > 0) {
                        if (child_title.length > 5) {
                            sub_title = child_title.substring(0,5) + "..."
                            $("select[name='organization'] option").eq(i).text(sub_title);
                        } else {
                            $("select[name='organization'] option").eq(i).text(child_title);
                        }
                    } 
                });
                $("select[name='cate'] option").each(function(i, item){
                    child_title = $("select[name='cate'] option").eq(i).attr("title");
                    if (child_title.length > 0) {
                        if (child_title.length > 5) {
                            sub_title = child_title.substring(0,5) + "..."
                            $("select[name='cate'] option").eq(i).text(sub_title);
                        } else {
                            $("select[name='cate'] option").eq(i).text(child_title);
                        }
                    } 
                });
                $("select[name='source'] option").each(function(i, item){
                    child_title = $("select[name='source'] option").eq(i).attr("title");
                    if (child_title.length > 0) {
                        if (child_title.length > 5) {
                            sub_title = child_title.substring(0,5) + "..."
                            $("select[name='source'] option").eq(i).text(sub_title);
                        } else {
                            $("select[name='source'] option").eq(i).text(child_title);
                        }
                    } 
                });
            }

            function putSum(isChecked) {
                // 判断是否检查指标
                
                if (isChecked) {
                    sumNameList = [], sumSumList = [], sumChoiceList = []

                    daysNameList = [], daysSeriesList = []

                    for (m in sumTotal) {
                        // 获取总数
                        total = sumTotal[m]['sum']
                        $("#"+m).text(total);
                        // 检查
                        checked = $("input[class=sumCount][name='"+m+"']").is(':checked')
                        if (checked) {
                            title = $("input[class=sumCount][name='"+m+"']").attr("title")
                            sumNameList.push(title)
                            sumSumList.push(total)

                            countList = sumTotal[m]['list']
                            daysNameList.push(title)
                            single_series = {name: title, type: 'line', stack: title, data: countList}
                            daysSeriesList.push(single_series)

                            sumChoiceList.push(m)
                        }

                    }

                } else {

                    sumNameList = [], sumSumList = []
                    daysNameList = [], daysSeriesList = []

                    for (m in sumTotal) {
                        // 获取总数
                        total = sumTotal[m]['sum']
                        $("#"+m).text(total);
                        // 默认指标
                        for (d in sumChoiceList) {
                            if (sumChoiceList[d] == m) {
                                title = $("input[class=sumCount][name='"+m+"']").attr("title")
                                sumNameList.push(title)
                                sumSumList.push(total)

                                countList = sumTotal[m]['list']
                                daysNameList.push(title)
                                single_series = {name: title, type: 'line', stack: title, data: countList}
                                daysSeriesList.push(single_series)

                            }
                        }
                    }
                }

            }

       
            function putSource() {
                // 判断是否检查指标
                
                sourceNameList = [], sourceSeriesList = [], pieSeriesList = []

                for (m in sourceTotal) {
                    source = sourceTotal[m]

                    select_name = $("select[name=source] option[value='"+m+"']").is(':selected')
                    if (select_name) {
                    
                        for (s in source) {
                            nn = ""
                            if (s == "1") {
                                nn = "ios"
                            }
                            if (s == "2") {
                                nn = "android"
                            }
                            // 获取总数
                            total = sourceTotal[m][s]['sum']
                            countList = sourceTotal[m][s]['list']

                            pieMap = {value: total, name: nn},
                            pieSeriesList.push(pieMap)
                            
                            sourceNameList.push(nn)
                            single_series = {name: nn, type: 'line', stack: nn, data: countList}
                            sourceSeriesList.push(single_series)
                        }
                    } 
                }
            }


            function putPlat(isChecked) {
                
                // 循环result
                product = ["product"]
                if (isChecked) {
                    platSource = [], platSeries = [], platChoiceList = []
                    // 设置source头
                    for (m in platTotal) {
                        title = $("input[class=platCount][name='"+m+"']").attr("title")
                        // 检查
                        checked = $("input[class=platCount][name='"+m+"']").is(':checked')
                        if (checked) {
                            product.push(title)
                            platChoiceList.push(m)
                        }
                    }
                    platSource.push(product)
                    // 循环平台列表
                    for (p in platMap) {
                        title = platMap[p]
                        pid = p
                        singleList = [title]
                        for (m in platTotal) {
                            pids = platTotal[m]
                            // 检查
                            checked = $("input[class=platCount][name='"+m+"']").is(':checked')
                            if (checked) {        
                                for (i in pids) {
                                    if (i == pid) {
                                        singleList.push(pids[i])
                                    }
                                }
                            }
                        }
                        platSource.push(singleList)

                    }
                    // 根据source设置series
                    for (i=1;i < platSource[0].length;i++) {
                        platSeries.push({type: 'bar'})
                    }
                } else {
                    platSource = [], platSeries = []
                    // 设置source头
                    for (m in platTotal) {
                        title = $("input[class=platCount][name='"+m+"']").attr("title")
                        for (d in platChoiceList) {
                            if (platChoiceList[d] == m) {
                                product.push(title)
                            }
                        }    
                    }
                    platSource.push(product)
                    // 循环平台列表
                    for (p in platMap) {
                        title = platMap[p]
                        pid = p
                        singleList = [title]
                        for (m in platTotal) {
                            pids = platTotal[m]
                            for (d in platChoiceList) {
                                if (platChoiceList[d] == m) {
                                    for (i in pids) {
                                        if (i == pid) {
                                            singleList.push(pids[i])
                                        }
                                    }
                                }
                            }
                        }
                        platSource.push(singleList)
                    }
                    // 根据source设置series
                    for (i=1;i < platSource[0].length;i++) {
                        platSeries.push({type: 'bar'})
                    }
                }

            }


            function putMedium(isChecked) {

                // 循环result
                product = ["product"]
                if (isChecked) {
                    medSource = [], medSeries = [], mediumChoiceList = []
                    // 设置source头
                    for (m in mediumTotal) {
                        title = $("input[class=mediumCount][name='"+m+"']").attr("title")
                        // 检查
                        checked = $("input[class=mediumCount][name='"+m+"']").is(':checked')
                        if (checked) {
                            product.push(title)
                            mediumChoiceList.push(m)
                        }
                    }
                    medSource.push(product)
                    // 循环平台列表
                    for (p in mediumMap) {
                        title = mediumMap[p]
                        pid = p
                        singleList = [title]
                        for (m in mediumTotal) {
                            pids = mediumTotal[m]
                            // 检查
                            checked = $("input[class=mediumCount][name='"+m+"']").is(':checked')
                            if (checked) {        
                                for (i in pids) {
                                    if (i == pid) {
                                        singleList.push(pids[i])
                                    }
                                }
                            }
                        }
                        medSource.push(singleList)

                    }
                    // 根据source设置series
                    for (i=1;i < medSource[0].length;i++) {
                        medSeries.push({type: 'bar'})
                    }
                } else {
                    medSource = [], medSeries = []
                    // 设置source头
                    for (m in platTotal) {
                        title = $("input[class=mediumCount][name='"+m+"']").attr("title")
                        for (d in mediumChoiceList) {
                            if (mediumChoiceList[d] == m) {
                                product.push(title)
                            }
                        }    
                    }
                    medSource.push(product)
                    // 循环平台列表
                    for (p in mediumMap) {
                        title = mediumMap[p]
                        pid = p
                        singleList = [title]
                        for (m in mediumTotal) {
                            pids = mediumTotal[m]
                            for (d in mediumChoiceList) {
                                if (mediumChoiceList[d] == m) {
                                    for (i in pids) {
                                        if (i == pid) {
                                            singleList.push(pids[i])
                                        }
                                    }
                                }
                            }
                        }
                        medSource.push(singleList)
                    }
                    // 根据source设置series
                    for (i=1;i < medSource[0].length;i++) {
                        medSeries.push({type: 'bar'})
                    }
                }

            }


            function putFan() {
                // 判断是否检查指标
                
                fanTopNameList = [], fanTopDataList = []
                taskTopNameList = [], taskTopDataList = []

                cateNameList = [], cateDataList = []

                for (m in organizationTotal) { 
                    fans = organizationTotal[m]
                    fans_select = $("select[name=organization] option[value='"+m+"']").is(':selected')
                    if (fans_select) {
                        for (s in fans) {
                            // 获取总数
                            title = organizationMap[fans[s][0]]
                            total = fans[s][1]
                            fanTopNameList.push(title)
                            fanTopDataList.push(total)
                        }
                    } 
                }

                for (m in advertTotal) { 
                    tasks = advertTotal[m]
                    tasks_select = $("select[name=advert] option[value='"+m+"']").is(':selected')
                    if (tasks_select) {
                        for (s in tasks) {
                            // 获取总数
                            title = advertMap[tasks[s][0]]
                            total = tasks[s][1]
                            taskTopNameList.push(title)
                            taskTopDataList.push(total)
                        }
                    } 
                }

                for (m in cateTotal) { 
                    cates = cateTotal[m]
                    cates_select = $("select[name=cate] option[value='"+m+"']").is(':selected')
                    if (cates_select) {
                        for (s in cates) {
                            // 获取总数
                            title = categoryMap[cates[s][0]]
                            total = cates[s][1]
                            cateNameList.push(title)
                            cateDataList.push(total)
                        }
                    } 
                }

            }

            function putIndus() {
                indusNameList = [], indusDataList = []
                checked = $("input[name=industry][value='pid']").is(':checked')
                if (checked) {
                    for (m in parentTotal) { 
                        indus = parentTotal[m]
                        indus_select = $("select[name=indus] option[value='"+m+"']").is(':selected')
                        if (indus_select) {
                            for (s in indus) {
                                // 获取总数
                                title = parentMap[indus[s][0]]
                                total = indus[s][1]
                                indusNameList.push(title)
                                indusDataList.push(total)
                            }
                        } 
                    }
                } else {
                    for (m in childTotal) { 
                        indus = childTotal[m]
                        indus_select = $("select[name=indus] option[value='"+m+"']").is(':selected')
                        if (indus_select) {
                            for (s in indus) {
                                // 获取总数
                                title = childMap[indus[s][0]]['name']
                                total = indus[s][1]
                                indusNameList.push(title)
                                indusDataList.push(total)
                            }
                        } 
                    }
                }

            }

            // 弹出层
            layui.use('layer', function(){
                var $ = layui.jquery, layer = layui.layer, form = layui.form;

                //触发事件
                var active = {
                    notice: function(){
                        //示范一个公告层
                        layer.open({
                            type: 1, title: ['数据说明', 'font-size:18px;'], closeBtn: false, area: ['50%','400px'], 
                            shade: 0.8, id: 'lay_notice', //设定一个id，防止重复弹出
                            btn: ['已知晓'], btnAlign: 'c', moveType: 1, //拖拽模式，0或者1
                            content:$("#notice").html(), success: function(layero){}
                        });
                    },
                    sum_choice: function(){
                        layer.open({
                            type: 1, title: ["所有指标", 'font-size:18px;'], closeBtn: 2, area: ['50%','400px'], 
                            shade: 0.8, id: 'sum_choice', btn: ['确认'],
                            yes: function(index, layero) {
                                putSum(true);
                                sumView();
                                layer.close(index);
                            },
                            btnAlign: 'c', anim: 1, moveType: 1, content:$("#sum_check").html(),
                            success: function(layero){
                                form.render(null, "sumForm");
                            }
                        });
                    },
                    plat_choice: function(){
                        layer.open({
                            type: 1, title: "所有指标", closeBtn: 2, area: ['50%','400px'], 
                            shade: 0.8, id: 'plat_choice', btn: ['确认'],
                            yes: function(index, layero) {
                                putPlat(true)
                                PlatMediumView()
                                layer.close(index);
                            },
                            btnAlign: 'c', anim: 1, moveType: 1, content:$("#plat_check").html(),
                            success: function(layero){
                                form.render(null, "platForm"); // 刷新checkbox开关渲染(否则开关按钮会不显示)
                            }
                        });
                    },
                    medium_choice: function(){
                        layer.open({
                            type: 1, title: "所有指标", closeBtn: 2, area: ['50%','400px'], 
                            shade: 0.8, id: 'medium_choice', btn: ['确认'],
                            yes: function(index, layero) {
                                putMedium(true)
                                PlatMediumView()
                                layer.close(index);
                            },
                            btnAlign: 'c', anim: 1, moveType: 1, content:$("#medium_check").html(),
                            success: function(layero){
                                form.render(null, "mediumForm"); // 刷新checkbox开关渲染(否则开关按钮会不显示)
                            }
                        });
                    }
                };
            
                $('#notice_button').on('click', function(){
                    var othis = $(this), method = othis.data('method');
                    active[method] ? active[method].call(this, othis) : '';
                });
                $('#sum_button').on('click', function(){
                    var othis = $(this), method = othis.data('method');
                    active[method] ? active[method].call(this, othis) : '';
                });
                $('#plat_button').on('click', function(){
                    var othis = $(this), method = othis.data('method');
                    active[method] ? active[method].call(this, othis) : '';
                });
                $('#medium_button').on('click', function(){
                    var othis = $(this), method = othis.data('method');
                    active[method] ? active[method].call(this, othis) : '';
                });


                form.on("select(media)", function(data){
                    parent_value = $("select[name='source']").parent()
                    select_title = data.elem.selectedOptions[0].title
                    layer.tips("<span class=\"layui-font-18\">"+select_title+"</span", parent_value, {tips: [4,"#0099CC"]})
                    putSource();
                    sourceView();
                    // alert(data.value); // 获取选中的值
                });

                form.on("select(account)", function(data){
                    parent_value = $("select[name='cate']").parent()
                    select_title = data.elem.selectedOptions[0].title
                    layer.tips("<span class=\"layui-font-18\">"+select_title+"</span", parent_value, {tips: [4,"#0099CC"]})
                    putFan();
                    cateTopView();
                });

                form.on('radio(level)', function(data){
                    putIndus();
                    cateTopView();
                });

                form.on("select(indus)", function(data){
                    parent_value = $("select[name='indus']").parent()
                    select_title = data.elem.selectedOptions[0].title
                    layer.tips("<span class=\"layui-font-18\">"+select_title+"</span", parent_value, {tips: [4,"#0099CC"]})
                    putIndus();
                    cateTopView();
                });

                form.on("select(organization)", function(data){
                    parent_value = $("select[name='organization']").parent()
                    select_title = data.elem.selectedOptions[0].title
                    layer.tips("<span class=\"layui-font-18\">"+select_title+"</span", parent_value, {tips: [4,"#0099CC"]})
                    putFan();
                    cateTopView();
                });

                form.on("select(advert)", function(data){
                    parent_value = $("select[name='advert']").parent()
                    select_title = data.elem.selectedOptions[0].title
                    layer.tips("<span class=\"layui-font-18\">"+select_title+"</span", parent_value, {tips: [4,"#0099CC"]})
                    putFan();
                    cateTopView();
                });

                $("select[name='indus']").next().find(" dd").each(function(i, item){
                    $("select[name='indus']").next().find(" dd").eq(i).mouseover(function() {
                        hover_text = $("select[name='indus'] option").eq(i).attr("title")
                        layer.tips("<span class=\"layui-font-18\">"+hover_text+"</span", this, {tips: 1, time: 1000})
                    });
                });
                $("select[name='advert']").next().find(" dd").each(function(i, item){
                    $("select[name='advert']").next().find(" dd").eq(i).mouseover(function() {
                        hover_text = $("select[name='advert'] option").eq(i).attr("title")
                        layer.tips("<span class=\"layui-font-18\">"+hover_text+"</span", this, {tips: 1, time: 1000})
                    });
                });
                $("select[name='organization']").next().find(" dd").each(function(i, item){
                    $("select[name='organization']").next().find(" dd").eq(i).mouseover(function() {
                        hover_text = $("select[name='organization'] option").eq(i).attr("title")
                        layer.tips("<span class=\"layui-font-18\">"+hover_text+"</span", this, {tips: 1, time: 1000})
                    });
                });
                $("select[name='cate']").next().find(" dd").each(function(i, item){
                    $("select[name='cate']").next().find(" dd").eq(i).mouseover(function() {
                        hover_text = $("select[name='cate'] option").eq(i).attr("title")
                        layer.tips("<span class=\"layui-font-18\">"+hover_text+"</span", this, {tips: 1, time: 1000})
                    });
                });
                $("select[name='source']").next().find(" dd").each(function(i, item){
                    $("select[name='source']").next().find(" dd").eq(i).mouseover(function() {
                        hover_text = $("select[name='source'] option").eq(i).attr("title")
                        layer.tips("<span class=\"layui-font-18\">"+hover_text+"</span", this, {tips: 1, time: 1000})
                    });
                });
            }); 

            // 时间趋势与指标对比情况
            function sumView() {
                var sumChart = echarts.init(document.getElementById('sumChart'));
                var daysChart = echarts.init(document.getElementById('daysChart'));

                var sumOption = {
                    title: {text: '指标累计值对比情况', left: 'center'}, 
                    tooltip: {}, legend: {},
                    grid: {left: '2%', right: '2%', bottom: '10%', containLabel: true},
                    xAxis: {type: 'category', data: sumNameList}, yAxis: {type: 'value'},
                    dataZoom: [{type: 'slider', height: 10, bottom: '2%'}],
                    series: [{name: '', type:'bar', barWidth: 20, data: sumSumList}],
                    aria: {enabled: true, decal: {show: true}}
                };
                var daysOption = {
                    title: {text: '指标日新增趋势图', left: 'center'},
                    tooltip: {trigger: 'axis'}, 
                    legend: {orient: 'horizontal', bottom: '5%', right: 'auto', data: daysNameList},
                    grid: {left: '2%', right: '2%', bottom: '15%', containLabel: true},
                    xAxis: {type: 'category', boundaryGap: false, axisLabel: {rotate: -90}, data: daysList}, 
                    yAxis: {type: 'value'},
                    dataZoom: [{type: 'slider', height: 10, bottom: '2%'}], 
                    series: daysSeriesList,
                };
                sumChart.setOption(sumOption, true);
                daysChart.setOption(daysOption, true);

            };

            function sourceView() {
                var mediaPie = echarts.init(document.getElementById('mediaPie'));
                var mediaLine = echarts.init(document.getElementById('mediaLine'));

                var pieOption = {
                    title: {text: '自媒体主在各来源分布情况', left: 'center'}, 
                    tooltip: {trigger: 'item'}, 
                    legend: {orient: 'vertical', top: 'center', right: 'right'},
                    grid: {left: '2%', right: '2%', bottom: '5%', containLabel: true},
                    series: [
                        {name: '设备来源', type: 'pie', radius: ['40%', '70%'], avoidLabelOverlap: false, 
                        itemStyle: {borderRadius: 10, borderColor: '#fff', borderWidth: 2},
                        label: {show: false, position: 'center'}, labelLine: {show: false},
                        emphasis: {
                            label: {show: true, fontSize: 30, fontWeight: 'bold'}},
                            labelLine: {show: false}, data: pieSeriesList
                        }
                    ],
                    aria: {enabled: true, decal: {show: true}}
                };

                var lineOption = {
                    title: {text: '各渠道用户变化趋势图', left: 'center'}, 
                    tooltip: {trigger: 'axis'}, 
                    legend: {orient: 'horizontal', bottom: '5%', right: 'auto', data: sourceNameList},
                    grid: {left: '2%', right: '2%', bottom: '15%', containLabel: true},
                    xAxis: {type: 'category', boundaryGap: false, axisLabel: {rotate: -90}, data: daysList}, 
                    yAxis: {type: 'value'},
                    dataZoom: [{type: 'slider', height: 10, bottom: '2%'}], 
                    series: sourceSeriesList
                };
                mediaPie.setOption(pieOption, true);
                mediaLine.setOption(lineOption, true);

            };


            function PlatMediumView() {
                // 基于准备好的dom，初始化echarts实例
                var platChart = echarts.init(document.getElementById('platChart'));
                var mediumChart = echarts.init(document.getElementById('mediumChart'));
                
                var platOption = {
                    title: {text: '各平台分布情况', left: 'center'}, 
                    legend: {orient: 'horizontal', bottom: '5%', right: 'auto'}, 
                    tooltip: {},
                    grid: {left: '2%', right: '2%', bottom: '15%', containLabel: true},
                    dataset: {source: platSource}, xAxis: {type: 'category'}, yAxis: {},
                    dataZoom: [{type: 'slider', height: 10, bottom: '2%'}], 
                    series: platSeries,
                    aria: {enabled: true, decal: {show: true}}
                };

                var mediumOption = {
                    title: {text: '各媒介分布情况', left: 'center'}, 
                    legend: {orient: 'horizontal', bottom: '5%', right: 'auto'}, 
                    tooltip: {},
                    grid: {left: '2%', right: '2%', bottom: '15%', containLabel: true},
                    dataset: {source: medSource}, xAxis: {type: 'category'}, yAxis: {},
                    dataZoom: [{type: 'slider', height: 10, bottom: '2%'}],
                    series: medSeries,
                    aria: {enabled: true, decal: {show: true}}
                };
    
                // 使用刚指定的配置项和数据显示图表。
                platChart.setOption(platOption, true);
                mediumChart.setOption(mediumOption, true);
            }

            function cateTopView() {
                var cateTopChart = echarts.init(document.getElementById('cateTopChart'));
                var indusTopChart = echarts.init(document.getElementById('indusTopChart'));

                var cateTopOption = {
                    title: {text: '排名前20领域分布情况', left: 'center'}, 
                    tooltip: {}, legend: {},
                    grid: {left: '2%', right: '10%', bottom: '2%', containLabel: true},
                    xAxis: {type: 'value'},
                    yAxis: {type: 'category', data: cateNameList, inverse: true},
                    dataZoom: [{type: 'slider', yAxisIndex: [0], width: 10, right: '2%'}],
                    series: [{name: '', type: 'bar', data: cateDataList}],
                    aria: {enabled: true, decal: {show: true}}
                };
                
                var indusTopOption = {
                    title: {text: '排名前20行业分布情况', left: 'center'}, 
                    tooltip: {}, legend: {},
                    grid: {left: '2%', right: '10%', bottom: '2%', containLabel: true},
                    xAxis: {type: 'value'},
                    yAxis: {type: 'category', data: indusNameList, inverse: true},
                    dataZoom: [{type: 'slider', yAxisIndex: [0], width: 10, right: '2%'}],
                    series: [{name: '', type: 'bar', data: indusDataList}],
                    aria: {enabled: true, decal: {show: true}}
                };

                cateTopChart.setOption(cateTopOption, true);
                indusTopChart.setOption(indusTopOption, true);


                var orgnTopChart = echarts.init(document.getElementById('orgnTopChart'));
                var adveTopChart = echarts.init(document.getElementById('adveTopChart'));

                var orgnTopOption = {
                    title: {text: '前20名机构分布情况', left: 'center'}, 
                    tooltip: {}, legend: {},
                    grid: {left: '2%', right: '10%', bottom: '2%', containLabel: true},
                    xAxis: {type: 'value'},
                    yAxis: {type: 'category', data: fanTopNameList, inverse: true},
                    dataZoom: [{type: 'slider', yAxisIndex: [0], width: 10, right: '2%'}],
                    series: [{name: '', type: 'bar', data: fanTopDataList}],
                    aria: {enabled: true, decal: {show: true}}
                };

                var adveTopOption = {
                    title: {text: '前20名广告主分布情况', left: 'center'}, 
                    tooltip: {}, legend: {},
                    grid: {left: '2%', right: '10%', bottom: '2%', containLabel: true},
                    xAxis: {type: 'value'},
                    yAxis: {type: 'category', data: taskTopNameList, inverse: true},
                    dataZoom: [{type: 'slider', yAxisIndex: [0], width: 10, right: '2%'}],
                    series: [{name: '', type: 'bar', data: taskTopDataList}],
                    aria: {enabled: true, decal: {show: true}}
                };

                orgnTopChart.setOption(orgnTopOption, true);
                adveTopChart.setOption(adveTopOption, true);

            }

            putSelect();
            getBase();
            getNow()
            getData();
            putSum(false);
            putSource();
            sumView();
            sourceView();
            
            putPlat(false)
            putMedium(false)
            PlatMediumView()

            putFan()
            putIndus()
            cateTopView()

        </script> 


    </body>
</html>